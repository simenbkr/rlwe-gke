#include <stdint.h>
#include "params.h"
#include <string.h>
#include "fft.h"
#include "reduction.h"

const uint64_t omega[1024] = {0, 1, 1, 38159621225, 1, 38159621225, 15675532427, 34320582150, 1, 38159621225, 15675532427, 34320582150, 44889369015, 23877795104, 14475398497, 37290234217, 1, 38159621225, 15675532427, 34320582150, 44889369015, 23877795104, 14475398497, 37290234217, 24609267322, 34884398330, 628024503, 11427851954, 37139111413, 28065196860, 32865737229, 2461160471, 1, 38159621225, 15675532427, 34320582150, 44889369015, 23877795104, 14475398497, 37290234217, 24609267322, 34884398330, 628024503, 11427851954, 37139111413, 28065196860, 32865737229, 2461160471, 6347365412, 34699234503, 18163770099, 32833106956, 26310190793, 1084494767, 34943492092, 18024625393, 249358786, 22356015293, 42429751981, 36271791672, 35294324248, 27796446819, 24587743612, 7612371546, 1, 38159621225, 15675532427, 34320582150, 44889369015, 23877795104, 14475398497, 37290234217, 24609267322, 34884398330, 628024503, 11427851954, 37139111413, 28065196860, 32865737229, 2461160471, 6347365412, 34699234503, 18163770099, 32833106956, 26310190793, 1084494767, 34943492092, 18024625393, 249358786, 22356015293, 42429751981, 36271791672, 35294324248, 27796446819, 24587743612, 7612371546, 33804953035, 8936066573, 11911985491, 10985122659, 16203900721, 6703212575, 9670175475, 7047246149, 21442030039, 15438733859, 37183102558, 45183171626, 25135381977, 31280457830, 7818962923, 29239152932, 33103925375, 40490036405, 19770009413, 24186697519, 17135187224, 5503808536, 40262948345, 18364939249, 16387480215, 17599061745, 5279879672, 45090508768, 42682158523, 18717061293, 12981451520, 34795975187, 1, 38159621225, 15675532427, 34320582150, 44889369015, 23877795104, 14475398497, 37290234217, 24609267322, 34884398330, 628024503, 11427851954, 37139111413, 28065196860, 32865737229, 2461160471, 6347365412, 34699234503, 18163770099, 32833106956, 26310190793, 1084494767, 34943492092, 18024625393, 249358786, 22356015293, 42429751981, 36271791672, 35294324248, 27796446819, 24587743612, 7612371546, 33804953035, 8936066573, 11911985491, 10985122659, 16203900721, 6703212575, 9670175475, 7047246149, 21442030039, 15438733859, 37183102558, 45183171626, 25135381977, 31280457830, 7818962923, 29239152932, 33103925375, 40490036405, 19770009413, 24186697519, 17135187224, 5503808536, 40262948345, 18364939249, 16387480215, 17599061745, 5279879672, 45090508768, 42682158523, 18717061293, 12981451520, 34795975187, 25223516030, 41341014969, 38326319736, 43638009130, 17933675997, 19193883491, 23310267231, 37156772663, 40756184097, 26215804295, 4405973025, 8040223664, 14939244914, 21341321151, 20665426239, 16493205628, 12503155833, 10735208363, 44522039193, 35069350501, 37087458194, 18527359666, 37358494807, 34922423634, 43058009335, 38208632714, 33922037564, 40658996551, 29484747122, 17759715991, 11762664450, 90023669, 19394284982, 3054844502, 11748779869, 5771640848, 35168899897, 20513453269, 14354680206, 42988285392, 21602714922, 36918726885, 21597051690, 9053801453, 9466209810, 10262130362, 8493227103, 26549011840, 12190645581, 14110843197, 30408264960, 11190384924, 33324500437, 21470943679, 33004825355, 40363805388, 7673614148, 7053710310, 5255148713, 13049041119, 14947360051, 10660567562, 14594037846, 26240938804, 1, 38159621225, 15675532427, 34320582150, 44889369015, 23877795104, 14475398497, 37290234217, 24609267322, 34884398330, 628024503, 11427851954, 37139111413, 28065196860, 32865737229, 2461160471, 6347365412, 34699234503, 18163770099, 32833106956, 26310190793, 1084494767, 34943492092, 18024625393, 249358786, 22356015293, 42429751981, 36271791672, 35294324248, 27796446819, 24587743612, 7612371546, 33804953035, 8936066573, 11911985491, 10985122659, 16203900721, 6703212575, 9670175475, 7047246149, 21442030039, 15438733859, 37183102558, 45183171626, 25135381977, 31280457830, 7818962923, 29239152932, 33103925375, 40490036405, 19770009413, 24186697519, 17135187224, 5503808536, 40262948345, 18364939249, 16387480215, 17599061745, 5279879672, 45090508768, 42682158523, 18717061293, 12981451520, 34795975187, 25223516030, 41341014969, 38326319736, 43638009130, 17933675997, 19193883491, 23310267231, 37156772663, 40756184097, 26215804295, 4405973025, 8040223664, 14939244914, 21341321151, 20665426239, 16493205628, 12503155833, 10735208363, 44522039193, 35069350501, 37087458194, 18527359666, 37358494807, 34922423634, 43058009335, 38208632714, 33922037564, 40658996551, 29484747122, 17759715991, 11762664450, 90023669, 19394284982, 3054844502, 11748779869, 5771640848, 35168899897, 20513453269, 14354680206, 42988285392, 21602714922, 36918726885, 21597051690, 9053801453, 9466209810, 10262130362, 8493227103, 26549011840, 12190645581, 14110843197, 30408264960, 11190384924, 33324500437, 21470943679, 33004825355, 40363805388, 7673614148, 7053710310, 5255148713, 13049041119, 14947360051, 10660567562, 14594037846, 26240938804, 13261521441, 15609277757, 37482805481, 955880695, 30762484136, 18602947666, 9179047912, 16440304009, 26398805564, 25714725372, 24716229271, 29171867566, 43657251459, 43144272331, 6547112394, 9964160450, 39915692375, 26213405772, 25105838048, 42587697102, 36792421391, 20462769414, 44821145713, 44751711797, 34066294725, 1699923359, 24100825017, 42537568085, 30328470391, 3587405463, 39393884503, 42289502373, 41247548874, 22056930076, 5465660558, 9786367760, 2940553529, 14837639082, 20342993102, 22489869726, 18938608186, 16759570123, 33311559715, 5991984398, 21937670567, 25455463721, 37540130063, 26831041234, 22983317370, 29352769432, 11600310388, 36852141860, 34398505015, 13694281052, 17939761522, 31275051856, 44536689124, 23182495639, 30195870540, 26932078361, 23937189148, 37893424312, 4419628574, 20316100054, 19317291355, 19222151587, 34347300569, 41380978173, 19062030802, 25534439577, 39476699596, 23279398068, 39363817453, 20336088090, 1642870901, 18991811697, 23338080382, 37299347274, 31573344604, 31145352725, 44876924808, 4602465000, 9299527990, 21454462160, 2062022959, 5613989248, 38942796561, 30943244844, 15049211702, 3316187664, 21946527042, 18757274555, 23916105669, 31220703151, 18497981221, 36292913183, 26829169612, 18633372593, 32397855824, 104955438, 32103087566, 37789494872, 24881366532, 2787666439, 6630928063, 39391733015, 3200873228, 40055244445, 5746128461, 43805388162, 14169264040, 4478635065, 45180013741, 9306808967, 31748936229, 39200844167, 35410174219, 5552777096, 19448954457, 1125780441, 22529554442, 21838850149, 36384373935, 14671197820, 8826868002, 21038713017, 37808306070, 39766435708, 1, 38159621225, 15675532427, 34320582150, 44889369015, 23877795104, 14475398497, 37290234217, 24609267322, 34884398330, 628024503, 11427851954, 37139111413, 28065196860, 32865737229, 2461160471, 6347365412, 34699234503, 18163770099, 32833106956, 26310190793, 1084494767, 34943492092, 18024625393, 249358786, 22356015293, 42429751981, 36271791672, 35294324248, 27796446819, 24587743612, 7612371546, 33804953035, 8936066573, 11911985491, 10985122659, 16203900721, 6703212575, 9670175475, 7047246149, 21442030039, 15438733859, 37183102558, 45183171626, 25135381977, 31280457830, 7818962923, 29239152932, 33103925375, 40490036405, 19770009413, 24186697519, 17135187224, 5503808536, 40262948345, 18364939249, 16387480215, 17599061745, 5279879672, 45090508768, 42682158523, 18717061293, 12981451520, 34795975187, 25223516030, 41341014969, 38326319736, 43638009130, 17933675997, 19193883491, 23310267231, 37156772663, 40756184097, 26215804295, 4405973025, 8040223664, 14939244914, 21341321151, 20665426239, 16493205628, 12503155833, 10735208363, 44522039193, 35069350501, 37087458194, 18527359666, 37358494807, 34922423634, 43058009335, 38208632714, 33922037564, 40658996551, 29484747122, 17759715991, 11762664450, 90023669, 19394284982, 3054844502, 11748779869, 5771640848, 35168899897, 20513453269, 14354680206, 42988285392, 21602714922, 36918726885, 21597051690, 9053801453, 9466209810, 10262130362, 8493227103, 26549011840, 12190645581, 14110843197, 30408264960, 11190384924, 33324500437, 21470943679, 33004825355, 40363805388, 7673614148, 7053710310, 5255148713, 13049041119, 14947360051, 10660567562, 14594037846, 26240938804, 13261521441, 15609277757, 37482805481, 955880695, 30762484136, 18602947666, 9179047912, 16440304009, 26398805564, 25714725372, 24716229271, 29171867566, 43657251459, 43144272331, 6547112394, 9964160450, 39915692375, 26213405772, 25105838048, 42587697102, 36792421391, 20462769414, 44821145713, 44751711797, 34066294725, 1699923359, 24100825017, 42537568085, 30328470391, 3587405463, 39393884503, 42289502373, 41247548874, 22056930076, 5465660558, 9786367760, 2940553529, 14837639082, 20342993102, 22489869726, 18938608186, 16759570123, 33311559715, 5991984398, 21937670567, 25455463721, 37540130063, 26831041234, 22983317370, 29352769432, 11600310388, 36852141860, 34398505015, 13694281052, 17939761522, 31275051856, 44536689124, 23182495639, 30195870540, 26932078361, 23937189148, 37893424312, 4419628574, 20316100054, 19317291355, 19222151587, 34347300569, 41380978173, 19062030802, 25534439577, 39476699596, 23279398068, 39363817453, 20336088090, 1642870901, 18991811697, 23338080382, 37299347274, 31573344604, 31145352725, 44876924808, 4602465000, 9299527990, 21454462160, 2062022959, 5613989248, 38942796561, 30943244844, 15049211702, 3316187664, 21946527042, 18757274555, 23916105669, 31220703151, 18497981221, 36292913183, 26829169612, 18633372593, 32397855824, 104955438, 32103087566, 37789494872, 24881366532, 2787666439, 6630928063, 39391733015, 3200873228, 40055244445, 5746128461, 43805388162, 14169264040, 4478635065, 45180013741, 9306808967, 31748936229, 39200844167, 35410174219, 5552777096, 19448954457, 1125780441, 22529554442, 21838850149, 36384373935, 14671197820, 8826868002, 21038713017, 37808306070, 39766435708, 22855443990, 37485515495, 20015145322, 42358604775, 39211879138, 5306769627, 5597289594, 40137673849, 27212236970, 34000274772, 10858396117, 42190802041, 9626138854, 31588395271, 32780884269, 11501198044, 16731503378, 1397840677, 28550473388, 35749002077, 42714378094, 5770632425, 15221283996, 4703464684, 29499885654, 11415817780, 970123599, 28274115783, 42119796687, 33581042538, 3989841629, 27178849362, 14693534116, 22167402412, 1774004681, 37507330980, 8032474073, 4875035460, 16205304066, 10159240808, 3222081636, 23028324063, 11656330372, 22132147450, 32533458448, 41068160173, 28532954417, 7377010834, 2041770644, 4363690298, 14810708444, 26241152101, 28888534300, 43030248827, 18340247021, 40670359024, 10694171256, 2041538626, 30532520460, 34468007811, 7847246657, 40454195316, 6930782483, 14777287457, 9123762101, 227473580, 347452986, 18117798322, 21940473017, 23742295182, 8341136693, 18490126772, 42401933983, 29220913662, 32426673541, 29002108155, 23473966995, 5249167227, 19803336169, 31340657627, 21015827871, 14947036655, 34776188858, 18240737673, 9947706581, 26390177047, 44055571215, 19647924465, 27020220155, 13375764914, 518116702, 24777775376, 20567140893, 36867342815, 37801889952, 14266538900, 13194199315, 6795546016, 6180356723, 11067943451, 31755026747, 31760905474, 35876800728, 37185698873, 42911376581, 11200498626, 38781972118, 36834611998, 22846292041, 24548982170, 34600886480, 17743029036, 2935994687, 26450089447, 11233006045, 40679139156, 21065794549, 44939611429, 17696222099, 36091736644, 1989606928, 10429943093, 9260584727, 2648416943, 33731065941, 22272874064, 38359320420, 28484145501, 34634197545, 37789909882, 6259376580, 28264512795, 45366354080, 4963896438, 21921806100, 38381048949, 10363065787, 1689210647, 32931453208, 4966291752, 3192336589, 32117960500, 14864461492, 18413634882, 18420527014, 13918631478, 19814066769, 1950799898, 4296065160, 36716192772, 2693830549, 35817275920, 32901112675, 17612518811, 7747037235, 23499426829, 25238467247, 16904606832, 27022730651, 13785995925, 12186028230, 21174052168, 25274798137, 5642745311, 860969183, 12206003485, 29275197895, 8880882504, 16050834962, 20254659953, 3996951822, 35597318679, 10662382583, 7853805617, 30215887059, 21861367419, 13985313220, 19503783922, 3204673454, 6378700290, 14639143251, 31751253824, 43213432648, 22962392557, 16464218302, 35662397772, 4755590163, 11966842242, 15391806604, 39664510500, 42992270, 26398393796, 20685062429, 41515808579, 6326815055, 3008836839, 38175848817, 32109537621, 31670706066, 22816194032, 20014891617, 14042745902, 16310602334, 17522267412, 6541774224, 10187918928, 1987060906, 4191260024, 29555096884, 14857298299, 29589923993, 27885593380, 41855793388, 19857902070, 41431842581, 37409469840, 42740799393, 36301988604, 17067802404, 34343274366, 35886310779, 16620593763, 21617504765, 4387327388, 16382404508, 22416011950, 13349815530, 38449112104, 12248763874, 4693828849, 31269031238, 3965703181, 18490286283, 40561730759, 31166966311, 39208231449, 17910784549, 36051361354, 33397196366, 23065833265, 20981486899, 5884022819, 32762075637, 10647908770, 13966653080, 8375716167, 12492714372, 22346763407, 32538907974, 26296101056, 5927637841, 11708840567, 36096943417, 35770788082, 40759164288, 11419711575, };
const uint64_t omega_inv[1024] = {0, 1, 1, 7350412184, 1, 7350412184, 11189451259, 29834500982, 1, 7350412184, 11189451259, 29834500982, 8219799192, 31034634912, 21632238305, 620664394, 1, 7350412184, 11189451259, 29834500982, 8219799192, 31034634912, 21632238305, 620664394, 43048872938, 12644296180, 17444836549, 8370921996, 34082181455, 44882008906, 10625635079, 20900766087, 1, 7350412184, 11189451259, 29834500982, 8219799192, 31034634912, 21632238305, 620664394, 43048872938, 12644296180, 17444836549, 8370921996, 34082181455, 44882008906, 10625635079, 20900766087, 37897661863, 20922289797, 17713586590, 10215709161, 9238241737, 3080281428, 23154018116, 45260674623, 27485408016, 10566541317, 44425538642, 19199842616, 12676926453, 27346263310, 10810798906, 39162667997, 1, 7350412184, 11189451259, 29834500982, 8219799192, 31034634912, 21632238305, 620664394, 43048872938, 12644296180, 17444836549, 8370921996, 34082181455, 44882008906, 10625635079, 20900766087, 37897661863, 20922289797, 17713586590, 10215709161, 9238241737, 3080281428, 23154018116, 45260674623, 27485408016, 10566541317, 44425538642, 19199842616, 12676926453, 27346263310, 10810798906, 39162667997, 10714058222, 32528581889, 26792972116, 2827874886, 419524641, 40230153737, 27910971664, 29122553194, 27145094160, 5247085064, 40006224873, 28374846185, 21323335890, 25740023996, 5019997004, 12406108034, 16270880477, 37691070486, 14229575579, 20374651432, 326861783, 8326930851, 30071299550, 24068003370, 38462787260, 35839857934, 38806820834, 29306132688, 34524910750, 33598047918, 36573966836, 11705080374, 1, 7350412184, 11189451259, 29834500982, 8219799192, 31034634912, 21632238305, 620664394, 43048872938, 12644296180, 17444836549, 8370921996, 34082181455, 44882008906, 10625635079, 20900766087, 37897661863, 20922289797, 17713586590, 10215709161, 9238241737, 3080281428, 23154018116, 45260674623, 27485408016, 10566541317, 44425538642, 19199842616, 12676926453, 27346263310, 10810798906, 39162667997, 10714058222, 32528581889, 26792972116, 2827874886, 419524641, 40230153737, 27910971664, 29122553194, 27145094160, 5247085064, 40006224873, 28374846185, 21323335890, 25740023996, 5019997004, 12406108034, 16270880477, 37691070486, 14229575579, 20374651432, 326861783, 8326930851, 30071299550, 24068003370, 38462787260, 35839857934, 38806820834, 29306132688, 34524910750, 33598047918, 36573966836, 11705080374, 19269094605, 30915995563, 34849465847, 30562673358, 32460992290, 40254884696, 38456323099, 37836419261, 5146228021, 12505208054, 24039089730, 12185532972, 34319648485, 15101768449, 31399190212, 33319387828, 18961021569, 37016806306, 35247903047, 36043823599, 36456231956, 23912981719, 8591306524, 23907318487, 2521748017, 31155353203, 24996580140, 10341133512, 39738392561, 33761253540, 42455188907, 26115748427, 45420009740, 33747368959, 27750317418, 16025286287, 4851036858, 11587995845, 7301400695, 2452024074, 10587609775, 8151538602, 26982673743, 8422575215, 10440682908, 987994216, 34774825046, 33006877576, 29016827781, 24844607170, 24168712258, 30570788495, 37469809745, 41104060384, 19294229114, 4753849312, 8353260746, 22199766178, 26316149918, 27576357412, 1872024279, 7183713673, 4169018440, 20286517379, 1, 7350412184, 11189451259, 29834500982, 8219799192, 31034634912, 21632238305, 620664394, 43048872938, 12644296180, 17444836549, 8370921996, 34082181455, 44882008906, 10625635079, 20900766087, 37897661863, 20922289797, 17713586590, 10215709161, 9238241737, 3080281428, 23154018116, 45260674623, 27485408016, 10566541317, 44425538642, 19199842616, 12676926453, 27346263310, 10810798906, 39162667997, 10714058222, 32528581889, 26792972116, 2827874886, 419524641, 40230153737, 27910971664, 29122553194, 27145094160, 5247085064, 40006224873, 28374846185, 21323335890, 25740023996, 5019997004, 12406108034, 16270880477, 37691070486, 14229575579, 20374651432, 326861783, 8326930851, 30071299550, 24068003370, 38462787260, 35839857934, 38806820834, 29306132688, 34524910750, 33598047918, 36573966836, 11705080374, 19269094605, 30915995563, 34849465847, 30562673358, 32460992290, 40254884696, 38456323099, 37836419261, 5146228021, 12505208054, 24039089730, 12185532972, 34319648485, 15101768449, 31399190212, 33319387828, 18961021569, 37016806306, 35247903047, 36043823599, 36456231956, 23912981719, 8591306524, 23907318487, 2521748017, 31155353203, 24996580140, 10341133512, 39738392561, 33761253540, 42455188907, 26115748427, 45420009740, 33747368959, 27750317418, 16025286287, 4851036858, 11587995845, 7301400695, 2452024074, 10587609775, 8151538602, 26982673743, 8422575215, 10440682908, 987994216, 34774825046, 33006877576, 29016827781, 24844607170, 24168712258, 30570788495, 37469809745, 41104060384, 19294229114, 4753849312, 8353260746, 22199766178, 26316149918, 27576357412, 1872024279, 7183713673, 4169018440, 20286517379, 5743597701, 7701727339, 24471320392, 36683165407, 30838835589, 9125659474, 23671183260, 22980478967, 44384252968, 26061078952, 39957256313, 10099859190, 6309189242, 13761097180, 36203224442, 330019668, 41031398344, 31340769369, 1704645247, 39763904948, 5454788964, 42309160181, 6118300394, 38879105346, 42722366970, 20628666877, 7720538537, 13406945843, 45405077971, 13112177585, 26876660816, 18680863797, 9217120226, 27012052188, 14289330258, 21593927740, 26752758854, 23563506367, 42193845745, 30460821707, 14566788565, 6567236848, 39896044161, 43448010450, 24055571249, 36210505419, 40907568409, 633108601, 14364680684, 13936688805, 8210686135, 22171953027, 26518221712, 43867162508, 25173945319, 6146215956, 22230635341, 6033333813, 19975593832, 26448002607, 4129055236, 11162732840, 26287881822, 26192742054, 25193933355, 41090404835, 7616609097, 21572844261, 18577955048, 15314162869, 22327537770, 973344285, 14234981553, 27570271887, 31815752357, 11111528394, 8657891549, 33909723021, 16157263977, 22526716039, 18678992175, 7969903346, 20054569688, 23572362842, 39518049011, 12198473694, 28750463286, 26571425223, 23020163683, 25167040307, 30672394327, 42569479880, 35723665649, 40044372851, 23453103333, 4262484535, 3220531036, 6116148906, 41922627946, 15181563018, 2972465324, 21409208392, 43810110050, 11443738684, 758321612, 688887696, 25047263995, 8717612018, 2922336307, 20404195361, 19296627637, 5594341034, 35545872959, 38962921015, 2365761078, 1852781950, 16338165843, 20793804138, 19795308037, 19111227845, 29069729400, 36330985497, 26907085743, 14747549273, 44554152714, 8027227928, 29900755652, 32248511968, 1, 7350412184, 11189451259, 29834500982, 8219799192, 31034634912, 21632238305, 620664394, 43048872938, 12644296180, 17444836549, 8370921996, 34082181455, 44882008906, 10625635079, 20900766087, 37897661863, 20922289797, 17713586590, 10215709161, 9238241737, 3080281428, 23154018116, 45260674623, 27485408016, 10566541317, 44425538642, 19199842616, 12676926453, 27346263310, 10810798906, 39162667997, 10714058222, 32528581889, 26792972116, 2827874886, 419524641, 40230153737, 27910971664, 29122553194, 27145094160, 5247085064, 40006224873, 28374846185, 21323335890, 25740023996, 5019997004, 12406108034, 16270880477, 37691070486, 14229575579, 20374651432, 326861783, 8326930851, 30071299550, 24068003370, 38462787260, 35839857934, 38806820834, 29306132688, 34524910750, 33598047918, 36573966836, 11705080374, 19269094605, 30915995563, 34849465847, 30562673358, 32460992290, 40254884696, 38456323099, 37836419261, 5146228021, 12505208054, 24039089730, 12185532972, 34319648485, 15101768449, 31399190212, 33319387828, 18961021569, 37016806306, 35247903047, 36043823599, 36456231956, 23912981719, 8591306524, 23907318487, 2521748017, 31155353203, 24996580140, 10341133512, 39738392561, 33761253540, 42455188907, 26115748427, 45420009740, 33747368959, 27750317418, 16025286287, 4851036858, 11587995845, 7301400695, 2452024074, 10587609775, 8151538602, 26982673743, 8422575215, 10440682908, 987994216, 34774825046, 33006877576, 29016827781, 24844607170, 24168712258, 30570788495, 37469809745, 41104060384, 19294229114, 4753849312, 8353260746, 22199766178, 26316149918, 27576357412, 1872024279, 7183713673, 4169018440, 20286517379, 5743597701, 7701727339, 24471320392, 36683165407, 30838835589, 9125659474, 23671183260, 22980478967, 44384252968, 26061078952, 39957256313, 10099859190, 6309189242, 13761097180, 36203224442, 330019668, 41031398344, 31340769369, 1704645247, 39763904948, 5454788964, 42309160181, 6118300394, 38879105346, 42722366970, 20628666877, 7720538537, 13406945843, 45405077971, 13112177585, 26876660816, 18680863797, 9217120226, 27012052188, 14289330258, 21593927740, 26752758854, 23563506367, 42193845745, 30460821707, 14566788565, 6567236848, 39896044161, 43448010450, 24055571249, 36210505419, 40907568409, 633108601, 14364680684, 13936688805, 8210686135, 22171953027, 26518221712, 43867162508, 25173945319, 6146215956, 22230635341, 6033333813, 19975593832, 26448002607, 4129055236, 11162732840, 26287881822, 26192742054, 25193933355, 41090404835, 7616609097, 21572844261, 18577955048, 15314162869, 22327537770, 973344285, 14234981553, 27570271887, 31815752357, 11111528394, 8657891549, 33909723021, 16157263977, 22526716039, 18678992175, 7969903346, 20054569688, 23572362842, 39518049011, 12198473694, 28750463286, 26571425223, 23020163683, 25167040307, 30672394327, 42569479880, 35723665649, 40044372851, 23453103333, 4262484535, 3220531036, 6116148906, 41922627946, 15181563018, 2972465324, 21409208392, 43810110050, 11443738684, 758321612, 688887696, 25047263995, 8717612018, 2922336307, 20404195361, 19296627637, 5594341034, 35545872959, 38962921015, 2365761078, 1852781950, 16338165843, 20793804138, 19795308037, 19111227845, 29069729400, 36330985497, 26907085743, 14747549273, 44554152714, 8027227928, 29900755652, 32248511968, 34090321834, 4750869121, 9739245327, 9413089992, 33801192842, 39582395568, 19213932353, 12971125435, 23163270002, 33017319037, 37134317242, 31543380329, 34862124639, 12747957772, 39626010590, 24528546510, 22444200144, 12112837043, 9458672055, 27599248860, 6301801960, 14343067098, 4948302650, 27019747126, 41544330228, 14241002171, 40816204560, 33261269535, 7060921305, 32160217879, 23094021459, 29127628901, 41122706021, 23892528644, 28889439646, 9623722630, 11166759043, 28442231005, 9208044805, 2769234016, 8100563569, 4078190828, 25652131339, 3654240021, 17624440029, 15920109416, 30652735110, 15954936525, 41318773385, 43522972503, 35322114481, 38968259185, 27987765997, 29199431075, 31467287507, 25495141792, 22693839377, 13839327343, 13400495788, 7334184592, 42501196570, 39183218354, 3994224830, 24824970980, 19111639613, 45467041139, 5845522909, 30118226805, 33543191167, 40754443246, 9847635637, 29045815107, 22547640852, 2296600761, 13758779585, 30870890158, 39131333119, 42305359955, 26006249487, 31524720189, 23648665990, 15294146350, 37656227792, 34847650826, 9912714730, 41513081587, 25255373456, 29459198447, 36629150905, 16234835514, 33304029924, 44649064226, 39867288098, 20235235272, 24335981241, 33324005179, 31724037484, 18487302758, 28605426577, 20271566162, 22010606580, 37762996174, 27897514598, 12608920734, 9692757489, 42816202860, 8793840637, 41213968249, 43559233511, 25695966640, 31591401931, 27089506395, 27096398527, 30645571917, 13392072909, 42317696820, 40543741657, 12578580201, 43820822762, 35146967622, 7128984460, 23588227309, 40546136971, 143679329, 17245520614, 39250656829, 7720123527, 10875835864, 17025887908, 7150712989, 23237159345, 11778967468, 42861616466, 36249448682, 35080090316, 43520426481, 9418296765, 27813811310, 570421980, 24444238860, 4830894253, 34277027364, 19059943962, 42574038722, 27767004373, 10909146929, 20961051239, 22663741368, 8675421411, 6728061291, 34309534783, 2598656828, 8324334536, 9633232681, 13749127935, 13755006662, 34442089958, 39329676686, 38714487393, 32315834094, 31243494509, 7708143457, 8642690594, 24942892516, 20732258033, 44991916707, 32134268495, 18489813254, 25862108944, 1454462194, 19119856362, 35562326828, 27269295736, 10733844551, 30562996754, 24494205538, 14169375782, 25706697240, 40260866182, 22036066414, 16507925254, 13083359868, 16289119747, 3108099426, 27019906637, 37168896716, 21767738227, 23569560392, 27392235087, 45162580423, 45282559829, 36386271308, 30732745952, 38579250926, 5055838093, 37662786752, 11042025598, 14977512949, 43468494783, 34815862153, 4839674385, 27169786388, 2479784582, 16621499109, 19268881308, 30699324965, 41146343111, 43468262765, 38133022575, 16977078992, 4441873236, 12976574961, 23377885959, 33853703037, 22481709346, 42287951773, 35350792601, 29304729343, 40634997949, 37477559336, 8002702429, 43736028728, 23342630997, 30816499293, 18331184047, 41520191780, 11928990871, 3390236722, 17235917626, 44539909810, 34094215629, 16010147755, 40806568725, 30288749413, 39739400984, 2795655315, 9761031332, 16959560021, 44112192732, 28778530031, 34008835365, 12729149140, 13921638138, 35883894555, 3319231368, 34651637292, 11509758637, 18297796439, 5372359560, 39912743815, 40203263782, 6298154271, 3151428634, 25494888087, 8024517914, 22654589419, };

static uint64_t modmul(uint64_t a, uint64_t b) {
    __uint128_t a_ = (__uint128_t) a;
    __uint128_t b_ = (__uint128_t) b;
    __uint128_t prod = a_ * b_;

    return barrett_128(prod);
}

void ntt(const uint64_t *roots, uint64_t *x) {

    //Cooley-Tukey NTT (ish)

    uint64_t m, i, j, k, t;
    uint64_t S, U, V;
    t = 512;

    m = 1;
    while (m < 1024) {
        k = 0;
        for (i = 0; i < m; i++) {
            S = roots[m + i];
            for (j = k; j < k + t; j++) {
                U = x[j];
                V = modmul(x[j + t], S);
                x[j] = (U + V) % GKE_Q;
                x[j + t] = (U + 3 * GKE_Q - V) % GKE_Q;
                //x[j + t] = U - V;
            }
            k += 2 * t;
        }
        t >>= 1;
        m <<= 1;
    }
}


void invntt(const uint64_t *iroots, uint64_t *x) {

    // Gentleman-Sande INTT (ish)

    uint64_t m, i, j, k, t;
    t = 1;
    uint64_t S, U, V, W;

    m = 512;

    while (m > 0) {
        k = 0;
        for (i = 0; i < m; i++) {
            S = iroots[m + i];
            for (j = k; j < k + t; j++) {
                U = x[j];
                V = x[j + t];
                x[j] = (U + V) % GKE_Q;
                W = (U - V + 3*GKE_Q) % GKE_Q;
                x[j + t] = modmul(W, S);
            }
            k += 2 * t;
        }
        t <<= 1;
        m >>= 1;
    }

    for (i = 0; i < 1024; i++) {
        x[i] = modmul(x[i], N_INVERSE);
    }
}


void convolution(const uint64_t *a, const uint64_t *b, uint64_t *res) {

    uint64_t a_copy[GKE_N], b_copy[GKE_N];

    memcpy(a_copy, a, sizeof(uint64_t) * GKE_N);
    memcpy(b_copy, b, sizeof(uint64_t) * GKE_N);


    ntt(omega, a_copy);
    ntt(omega, b_copy);

    int i;
    for (i = 0; i < 1024; ++i) {
        res[i] = modmul(a_copy[i], b_copy[i]);
    }

    invntt(omega_inv, res);
}